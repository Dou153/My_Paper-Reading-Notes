# 签名算法





## 双线性配对



### 双线性映射

双线性映射$e:G_1\times G_2\rightarrow G_3$

对于任意的$a_1,a_2\in G_1;b_1,b_2\in G_2$，有以下性质
$$
\begin{align}
	e(\alpha a_1+\beta a_2,b_1) = \alpha e(a_1,b_1)+\beta e(a_2,b_1)\\
	e(a_1,\alpha b_1+\beta b_2) = \alpha e(a_1,b_1)+\beta e(a_1,b_2)
\end{align}
$$
即对2个变量都线性



### 双线性配对

在《An Efficient Signature Scheme from Bilinear Pairings and Its Applications》这篇文献中，有关双线性配对的描述如下：

  Let $\mathbb{G}_1$ be a cyclic additive group generated by $P$, whose order is a prime $q$, and $\mathbb{G}_2$ be a cyclic multiplicative group with the same order $q.$ Let $e:\mathbb{G}_1\times\mathbb{G}_1\to\mathbb{G}_2$ be a map with the following properties:

$1. \textbf{ Bilinearity:  }e( aP, bQ) = e( P, Q) ^{ab}$ for all $P,Q\in\mathbb{G}_1,a,b\in\mathbb{Z}_q$
$2. \textbf{ Non- degeneracy:  There exists }P, Q\in \mathbb{G} _1$ such that $e(P,Q)\neq1$, in other words, the map does not send all pairs in $\mathbb{G}_1\times\mathbb{G}_1$ to the identity in $\mathbb{G}_2;$
$3. \textbf{ Computability:  There is an effcient algorithm to compute }e( P, Q)$ for all $P,Q\in\mathbb{G}_1.$

In our setting of prime order groups, the **Non-degeneracy** is equivalent to $e(P,Q)\neq1$ for all $P,Q\in\mathbb{G}_1.$ So, when $P$ is a generator of $\mathbb{G}_1$, $e(P,P)$ is a generator of $\mathbb{G}_2$. Such a bilinear map is called a bilinear pairing (more precisely, called an admissible bilinear pairing).





双线性映射可以通过有限域上的超椭圆曲线上的Tate对或Weil对来构造。




### BLS签名

BLS短签名基于乘法循环群上的CDH问题的困难性假设。



BLS短签名构造在**间隙群**上，在间隙群上使用双线性映射解决DDH问题是容易的，但CDH问题是困难的。（见现代密码学教材）

（双线性配对）$\hat{e}:G_1\times G_1\rightarrow G_T$。**G1是椭圆曲线加法循环群。GT是一个有限域上的乘法循环群。**

设$G$是间隙群，$H:\{0,1\}^* \rightarrow G$是全域安全哈希函数

**密钥产生：**
$$
\begin{align}
&x \leftarrow_R Z_q(模q的整数域上的数字)\\
&y=g^x\in G\\
&sk=x,pk=y
\end{align}
$$
**签名过程：**M是要签名的消息
$$
\begin{align}
&h=H(M)\\
&输出:\sigma=h^x\in G\\

\end{align}
$$
**验证过程：**
$$
\begin{align}
&h=H(M)\\
&验证:\hat{e}(g,\sigma)=\hat{e}(h,y)\\

\end{align}
$$



**同时对多个消息签名验证**

不同消息的私钥$sk_i$和公钥$pk_i$和上面的生成流程一样

对各自的消息生成签名$\sigma_i=h_i^{x_i}\in G,h_i=H(M_i)$

验证过程
$$
\begin{align}
\hat{e}(g,\sum_i\sigma_i)=\prod_i\hat{e}(h_i,y_i)
\end{align}
$$


### Schnorr 签名

**密钥生成**：
$$

$$






## SM1对称密码（不公开，仅以IP核的形式存在于芯片中）



## SM2椭圆曲线公钥密码算法











## SM9